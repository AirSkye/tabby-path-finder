//cc8变种 XString.equals to toString
match (source:Method {NAME:"readObject",IS_SERIALIZABLE:true, CLASSNAME:"java.util.Hashtable"})
with collect(source) as sources
match (sink:Method {IS_SINK:true, NAME:"invoke"})
call tabby.algo.findJavaGadget(sink, sources, 12, null, false, false) yield path where none(n in nodes(path) where n.NAME0 in ["java.util.Map$Entry.getValue","java.lang.Object.hashCode","javax.management.ImmutableDescriptor.equals","javax.swing.text.html.HTML$UnknownTag.equals"])
return path limit 1


//tabby endpoint to sink search
match (source:Method {NAME:"readObject",IS_SERIALIZABLE:true, CLASSNAME:"java.util.Hashtable"})
with collect(source) as sources
match (sink:Method {IS_SINK:true, NAME:"invoke"})
call tabby.algo.findJavaGadget(sink, sources, 12, null, false, false) yield path where none(n in nodes(path) where n.NAME0 in ["java.util.Map$Entry.getValue"])
return path limit 1